<template>
  <section>
    <h1 class="text-center my-3 title">
      InstaEditor - —Ä–µ–¥–∞–∫—Ç–æ—Ä —Ç–µ–∫—Å—Ç–∞ –¥–ª—è –ò–Ω—Å—Ç–∞–≥—Ä–∞–º
    </h1>
    <b-form-textarea
      ref="textarea"
      v-model="text"
      placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç... –ù–∞–∂–º–∏—Ç–µ 1 —Ä–∞–∑ Enter –¥–ª—è –Ω–æ–≤–æ–π —Å—Ç—Ä–æ–∫–∏ –∏ 2 —Ä–∞–∑–∞ –¥–ª—è –ø—É—Å—Ç–æ–π —Å—Ç—Ä–æ–∫–∏ üòâ"
      rows="14"
      :state="text.length <= maxTextLength"
    />
    <small class="float-right">
      {{ this.text.length }} / {{ this.maxTextLength }}
    </small>
    <div class="mt-3">
      <b-button @click="copyTextarea" variant="outline-primary">
        –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å
      </b-button>
      <b-button @click="text = ''" variant="outline-danger">
        –û—á–∏—Å—Ç–∏—Ç—å
      </b-button>
    </div>

    <hr />

    <p>
      Instagram&nbsp;&mdash; —É–∂–µ –¥–∞–≤–Ω–æ –Ω–µ&nbsp;–ø—Ä–æ—Å—Ç–æ –ø–ª–æ—â–∞–¥–∫–∞ –¥–ª—è –ø—É–±–ª–∏–∫–∞—Ü–∏–∏
      –µ–¥—ã –∏–ª–∏ —Å–µ–ª—Ñ–∏. –ù–∞—Å—Ç–æ—è—â–∏–µ –±–ª–æ–≥–µ—Ä—ã –ø—Ä–∏–≤–ª–µ–∫–∞—é—Ç –∞—É–¥–∏—Ç–æ—Ä–∏—é —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–º –ø–æ–ª–µ–∑–Ω—ã–º
      —Ç–µ–∫—Å—Ç–æ–≤—ã–º –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º –∏&nbsp;—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ –∑–∞—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç –Ω–∞&nbsp;—ç—Ç–æ–º.
    </p>
    <p>
      <strong>–ë–µ–∑ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–∞ –Ω–∞&nbsp;–∞–±–∑–∞—Ü—ã&nbsp;</strong>&mdash;
      —É&nbsp;–≤–∞—Å –ø–æ–ª—É—á–∏—Ç—Å—è &laquo;–ø—Ä–æ—Å—Ç—ã–Ω—å&raquo; –∏–∑&nbsp;–±—É–∫–≤, —á–∏—Ç–∞—Ç—å –∫–æ—Ç–æ—Ä—É—é
      –Ω–µ—É–¥–æ–±–Ω–æ! –ò–º–µ–Ω–Ω–æ –ø–æ—ç—Ç–æ–º—É –ø–æ—è–≤–∏–ª–∏—Å—å —Å–∞–π—Ç&nbsp;/ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä—ã–µ —Ä–µ—à–∞—é—Ç
      —ç—Ç—É –ø—Ä–æ–±–ª–µ–º—É.
    </p>
    <p class="mb-3">
      –í–æ–∑–º–æ–∂–Ω–æ, –≤–∞–º –±—É–¥—É—Ç –ø–æ–ª–µ–∑–Ω—ã –∏&nbsp;–¥—Ä—É–≥–∏–µ —Å–µ—Ä–≤–∏—Å—ã –¥–ª—è Instagram.
    </p>
    <h2 class="text-center mt-3">–°–µ—Ä–≤–∏—Å —Å–æ–∑–¥–∞–Ω–∏—è —Ñ–µ–π–∫–æ–≤–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏</h2>
    <a href="https://v2.instafakestats.ru" target="_blank">
      <img
        class="mt-3 instafakestats"
        src="/instafakestats.gif"
        alt="–°–∞–π—Ç instafakestats.ru"
      />
    </a>
    <span class="mt-3 text-center instafakestats">
      <b-button
        href="https://v2.instafakestats.ru"
        target="_blank"
        variant="outline-primary"
      >
        –ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ —Å–∞–π—Ç
      </b-button>
    </span>
  </section>
</template>

<script>
import { showToast } from "../utils/toast";
import messages from "../data/messages.json";

const LOCAL_STORAGE_NAME = "instaeditor";

export default {
  data() {
    return {
      text: "",
      maxTextLength: 2200
    };
  },

  methods: {
    async copyTextarea() {
      if (this.text.length > this.maxTextLength) {
        return showToast(messages["max-length"]);
      }

      try {
        const text = this.$refs.textarea.value.replace(/\n/g, "‚†Ä\n");
        await this.$copyText(text);
        showToast(messages["copied"], "–ò–Ω—Ñ–æ", "success");
      } catch (e) {
        console.error(e);
        showToast(e.message);
      }
    }
  },

  mounted() {
    if (localStorage.LOCAL_STORAGE_NAME) {
      this.text = localStorage.LOCAL_STORAGE_NAME;
    }
  },

  watch: {
    text(text) {
      localStorage.LOCAL_STORAGE_NAME = text;
    }
  }
};
</script>

<style scoped>
.title {
  font-size: 20px;
}

@media screen and (min-width: 576px) {
  .title {
    font-size: 40px;
  }
}
</style>
